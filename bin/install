#!/bin/bash

# Get the version to install
if [ -z "${1:-}" ]; then
    echo "Error: version parameter is required"
    exit 1
fi
version="$1"

if [ -z "${2:-}" ]; then
    echo "Error: install path parameter is required"
    exit 1
fi
install_path="$2"

# Create a temporary directory
temp_dir=$(mktemp -d)
trap 'rm -rf "$temp_dir"' EXIT

# Clone the repository
git clone https://github.com/NethermindEth/starknet-contract-verifier.git "$temp_dir"
cd "$temp_dir"
git checkout "v$version"

# Build the binary
cargo build --release

# Create the installation directory
mkdir -p "$install_path/bin"

# Copy the binary to the installation directory
cp target/release/starknet-contract-verifier "$install_path/bin/"

# Make the binary executable
chmod +x "$install_path/bin/starknet-contract-verifier" 