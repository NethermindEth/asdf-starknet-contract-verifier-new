#!/usr/bin/env bash

set -e

# Get the version to install
version="$1"
install_path="$2"

# Create a temporary directory
temp_dir=$(mktemp -d)
trap 'rm -rf "$temp_dir"' EXIT

# Clone the repository
git clone https://github.com/NethermindEth/starknet-contract-verifier.git "$temp_dir"
cd "$temp_dir"
git checkout "v$version"

# Build the binary
cargo build --release

# Create the installation directory
mkdir -p "$install_path/bin"

# Copy the binary to the installation directory
cp target/release/starknet-contract-verifier "$install_path/bin/"

# Make the binary executable
chmod +x "$install_path/bin/starknet-contract-verifier" 